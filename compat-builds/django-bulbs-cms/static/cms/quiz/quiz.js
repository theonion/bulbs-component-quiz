"use strict";angular.module("bulbs.quiz.api.answer",["restmod"]).factory("QuizAnswer",["restmod",function(a){return a.model("answer").mix("NestedDirtyModel",{$config:{name:"QuizAnswer",plural:"QuizAnswers",primaryKey:"id"},question:{init:null},body:{init:""},outcome:{init:null},isCorrect:{init:!1},explanation:{init:""},points:{init:1}})}]),angular.module("bulbs.quiz.api.outcome",["restmod"]).factory("QuizOutcome",["restmod",function(a){return a.model("outcome").mix("NestedDirtyModel",{$config:{name:"QuizOutcome",plural:"QuizOutcomes",primaryKey:"id"},title:{init:""},body:{init:""},sharable:{init:!1},minScore:{init:0},quiz:{init:null},requirePerfect:{init:!1}})}]),angular.module("bulbs.quiz.api.question",["bulbs.quiz.api.answer","restmod"]).factory("QuizQuestion",["restmod",function(a){return a.model("question").mix("NestedDirtyModel",{$config:{name:"QuizQuestion",plural:"QuizQuestions",primaryKey:"id"},answers:{belongsToMany:"QuizAnswer",keys:"answer_set"},body:{init:""},postAnswerBody:{init:""},outcome:{init:null},quiz:{init:null}})}]),angular.module("bulbs.quiz.api.quiz",["bulbs.quiz.api.outcome","bulbs.quiz.api.question","restmod"]).factory("Quiz",["restmod",function(a){return a.model("content").mix("NestedDirtyModel",{$config:{name:"Quiz",plural:"Quizzes",primaryKey:"id"},outcomes:{belongsToMany:"QuizOutcome",keys:"outcome_set"},questions:{belongsToMany:"QuizQuestion",keys:"question_set"}})}]),angular.module("bulbs.quiz.edit.outcomes.outcome",["bettyEditable","uuid4"]).directive("quizEditOutcomesOutcome",["uuid4",function(a){return{link:function(b){b.uuid=a.generate()},restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes-outcome/quiz-edit-outcomes-outcome.html",scope:{outcome:"=",quizStyle:"@"}}}]),angular.module("bulbs.quiz.edit.outcomes",["bulbs.quiz.api.outcome","bulbs.quiz.edit.outcomes.outcome","utils"]).directive("quizEditOutcomes",function(){return{controller:["$scope","QuizOutcome","Utils",function(a,b,c){a.outcomeMove=function(b,d){c.moveTo(a.outcomes,b,d)},a.outcomeDelete=function(b,d){b.$destroy(),c.removeFrom(a.outcomes,d)},a.outcomeAdd=function(){var c=b.$create({quiz:a.articleId});a.outcomes.push(c)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes.html",scope:{articleId:"=",outcomes:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.questions.question.answer",["uuid4"]).directive("quizEditQuestionsQuestionAnswer",["uuid4",function(a){return{link:function(b){b.uuid=a.generate()},restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question-answer/quiz-edit-questions-question-answer.html",scope:{answer:"=",quizStyle:"=",outcomes:"="}}}]),angular.module("bulbs.quiz.edit.questions.question",["bulbs.quiz.api.answer","bulbs.quiz.questions.question.answer","utils"]).directive("quizEditQuestionsQuestion",function(){return{controller:["$scope","QuizAnswer","Utils",function(a,b,c){a.answerMove=function(b,d){c.moveTo(a.question.answers,b,d)},a.answerDelete=function(b,d){b.$destroy(),c.removeFrom(a.question.answers,d)},a.answerAdd=function(c){var d=b.$create({question:a.question.id});a.question.answers.push(d)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question.html",scope:{outcomes:"=",question:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.edit.questions",["bulbs.quiz.api.question","bulbs.quiz.edit.questions.question","utils"]).directive("quizEditQuestions",function(){return{controller:["$scope","QuizQuestion","Utils",function(a,b,c){a.questionMove=function(b,d){c.moveTo(a.questions,b,d)},a.questionDelete=function(b,d){b.$destroy(),c.removeFrom(a.questions,d)},a.questionAdd=function(){var c=b.$create({quiz:a.articleId});a.questions.push(c)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions.html",scope:{articleId:"=",questions:"=",outcomes:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.edit",["bulbs.quiz.api.quiz","bulbs.quiz.edit.outcomes","bulbs.quiz.edit.questions"]).directive("quizEdit",[function(){return{restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit.html",scope:{articleId:"="},controller:["$scope","Quiz",function(a,b){a.quiz=b.$find(a.articleId)}]}}]),angular.module("bulbs.quiz",["bulbs.quiz.edit","bulbs.quiz.templates"]),angular.module("bulbs.quiz.templates",[]).run(["$templateCache",function(a){a.put("bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes-outcome/quiz-edit-outcomes-outcome.html",'<div class=col-sm-7><div class=form-group><label for="quizEditOutcomesOutcomeHeadline{{ uuid }}">Result Headline</label><input id="quizEditOutcomesOutcomeHeadline{{ uuid }}" class=form-control ng-model=outcome.title placeholder="Title of result"></div><div class=form-group><label for="quizEditOutcomesOutcomeDescription{{ uuid }}">Result Description</label><textarea id="quizEditOutcomesOutcomeDescription{{ uuid }}" class=form-control rows=3 ng-model=outcome.body placeholder="Description of result">\n    </textarea></div><div class="form-group form-inline" ng-show="quizStyle === \'tally\' || quizStyle === \'test\' || quizStyle === \'cosmo\'"><label for="quizEditOutcomesOutcomeScore{{ uuid }}">This result requires a minimum score of</label><input id="quizEditOutcomesOutcomeScore{{ uuid }}" class=form-control type=number ng-model=outcome.minScore placeholder=1 size=5></div><div class=form-group><label for="quizEditOutcomesOutcomeShareable{{ uuid }}">This result is shareable</label><input id="quizEditOutcomesOutcomeShareable{{ uuid }}" type=checkbox ng-model=outcome.shareable></div><div class=quiz-edit-outcomes-outcome-perfect ng-show="quizStyle === \'multiple\'"><label>Perfect score required</label><input type=checkbox ng-model=outcome.requirePerfect></div></div><div class=col-sm-5><label>Add Image</label><betty-editable image=outcome.image ratio=1x1 add-styles="fa fa-camera-retro add-image-box quiz-image-box"></betty-editable></div>'),a.put("bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes.html",'<h4>Possible Results</h4><ul class=quiz-panel-list><li class="panel panel-default quiz-panel" ng-repeat="outcome in outcomes"><div class=panel-heading data-toggle=collapse data-target="#outcome{{ $index }}"><div class=quiz-panel-heading><span>Result {{ $index + 1 }}</span> <span ng-if=outcome.title>:</span> <span ng-bind-html="outcome.title | truncateByWords:7"></span></div><div class=quiz-panel-toolbar><div class=btn-group><button class="btn btn-xs btn-info" ng-click="outcomeMove($index, $index - 1); $event.stopPropagation();" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button class="btn btn-xs btn-info" ng-click="outcomeMove($index, $index + 1); $event.stopPropagation();" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div class=btn-group><button class="btn btn-xs btn-danger" title="Delete outcome" ng-click="outcomeDelete(outcome, $index); $event.stopPropagation();"><span class="fa fa-trash-o"></span></button></div></div></div><quiz-edit-outcomes-outcome id="outcome{{ $index }}" class="panel-body collapse" outcome=outcome quiz-style=quizStyle></quiz-edit-outcomes-outcome></li></ul><div><button class="btn btn-primary" ng-click=outcomeAdd()><span class="fa fa-plus"></span> <span>Add A Result</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question-answer/quiz-edit-questions-question-answer.html",'<div class=col-sm-7><div class=form-group><label>Text</label><onion-editor ng-model=answer.body role=singleline placeholder=Answer formatting=bold,italic,strike></onion-editor></div><div class="form-group form-inline" ng-show="quizStyle === \'tally\' || quizStyle === \'cosmo\'"><label for="answerPoints{{ uuid }}">Points</label><input id="answerPoints{{ uuid }}" class=form-control type=number ng-model=answer.points placeholder=1 size=3></div><div class=form-group ng-show="quizStyle === \'multiple\'"><label for="answerOutcome{{ uuid }}">Connect the answer with this result</label><select id="answerOutcome{{ uuid }}" class=form-control ng-model=answer.outcome ng-options="outcome.id as outcome.title for outcome in outcomes"></select></div><div class=form-group ng-show="quizStyle === \'test\'"><label for="answerCorrect{{ uuid }}">Correct?</label><input id="answerCorrect{{ uuid }}" type=checkbox ng-model=answer.isCorrect></div><div class=form-group ng-show="quizStyle === \'test\'"><label>Answer Explanation</label><onion-editor ng-model=answer.explanation role=multiline placeholder="Answer Explanation"></onion-editor></div></div><div class=col-sm-5><label>Add Image</label><betty-editable image=answer.image ratio=1x1 add-styles="fa fa-camera-retro add-image-box quiz-image-box"></betty-editable></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question.html",'<div><div><label>Question</label><onion-editor ng-model=question.body role=multiline placeholder="Question Body"></onion-editor></div><div ng-show="[\'multiple\', \'cosmo\', \'test\'].indexOf(quizStyle) > -1"><label>Optional post-answer content</label><onion-editor ng-model=question.postAnswerBody role=multiline placeholder="Post Answer Body"></onion-editor></div></div><ul class=quiz-panel-list><li class="panel panel-default quiz-panel" ng-repeat="answer in question.answers"><div class=panel-heading data-toggle=collapse data-target="#answer{{ $index }}"><div class=quiz-panel-heading><span>Answer {{ $index + 1 }}</span> <span ng-if=answer.body>:</span> <span ng-bind-html="answer.body | truncateByWords:7"></span></div><div class=quiz-panel-toolbar><div class=btn-group><button class="btn btn-xs btn-info" ng-click="answerMove($index, $index - 1); $event.stopPropagation();" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button class="btn btn-xs btn-info" ng-click="answerMove($index, $index + 1); $event.stopPropagation();" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div class=btn-group><button class="btn btn-xs btn-danger" title="Delete answer" ng-click="answerDelete(answer, $index); $event.stopPropagation();"><span class="fa fa-trash-o"></span></button></div></div></div><quiz-edit-questions-question-answer id="answer{{ $index }}" class="panel-body collapse" answer=answer outcomes=outcomes quiz-style=quizStyle></quiz-edit-questions-question-answer></li></ul><div><button class="btn btn-primary" ng-click=answerAdd()><span class="fa fa-plus"></span> <span>Add An Answer</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions.html",'<h4>Questions</h4><ul class=quiz-panel-list><li class="panel panel-default quiz-panel" ng-repeat="question in questions"><div class=panel-heading data-toggle=collapse data-target="#question{{ $index }}"><div class=quiz-panel-heading><span>Question {{ $index + 1 }}</span></div><div class=quiz-panel-toolbar><div class=btn-group><button class="btn btn-xs btn-info" ng-click="questionMove($index, $index - 1); $event.stopPropagation();" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button class="btn btn-xs btn-info" ng-click="questionMove($index, $index + 1); $event.stopPropagation();" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div class=btn-group><button class="btn btn-xs btn-danger" title="Delete question" ng-click="questionDelete(question, $index); $event.stopPropagation();"><span class="fa fa-trash-o"></span></button></div></div></div><quiz-edit-questions-question id="question{{ $index }}" class="panel-body collapse" outcomes=outcomes question=question quiz-style=quizStyle></quiz-edit-questions-question></li></ul><div><button class="btn btn-primary" ng-click=questionAdd()><span class="fa fa-plus"></span> <span>Add A Question</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit.html",'<section class="well row"><h4>Quiz Options</h4><div class="form-group col-sm-12" ng-show="quiz.quizStyle === \'test\'"><label for=revealAnswers>Reveal other answers after answering</label><input id=revealAnswers type=checkbox ng-model=quiz.showAllAnswers></div><div class="form-group col-sm-3"><label for=resultButtonText>Result Button Text</label><input id=resultButtonText class=form-control ng-model=quiz.resultButtonText placeholder="Get Results"></div></section><quiz-edit-outcomes class="well row" article-id=quiz.id outcomes=quiz.outcomes quiz-style=quiz.quizStyle></quiz-edit-outcomes><quiz-edit-questions class="well row" article-id=quiz.id questions=quiz.questions outcomes=quiz.outcomes quiz-style="{{ quiz.quizStyle }}"></quiz-edit-questions>')}]);