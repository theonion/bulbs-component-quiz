"use strict";angular.module("bulbs.quiz.api.answer",["restmod"]).factory("QuizAnswer",["restmod",function(a){return a.model("answer").mix("NestedDirtyModel",{$config:{name:"QuizAnswer",plural:"QuizAnswers",primaryKey:"id"},question:{init:null},body:{init:""},outcome:{init:null},isCorrect:{init:!1},explanation:{init:""},points:{init:1}})}]),angular.module("bulbs.quiz.api.outcome",["restmod"]).factory("QuizOutcome",["restmod",function(a){return a.model("outcome").mix("NestedDirtyModel",{$config:{name:"QuizOutcome",plural:"QuizOutcomes",primaryKey:"id"},title:{init:""},body:{init:""},sharable:{init:!1},minScore:{init:0},quiz:{init:null},requirePerfect:{init:!1}})}]),angular.module("bulbs.quiz.api.question",["bulbs.quiz.api.answer","restmod"]).factory("QuizQuestion",["restmod",function(a){return a.model("question").mix("NestedDirtyModel",{$config:{name:"QuizQuestion",plural:"QuizQuestions",primaryKey:"id"},answers:{belongsToMany:"QuizAnswer",keys:"answer_set"},body:{init:""},postAnswerBody:{init:""},outcome:{init:null},quiz:{init:null}})}]),angular.module("bulbs.quiz.api.quiz",["bulbs.quiz.api.outcome","bulbs.quiz.api.question","restmod"]).factory("Quiz",["restmod",function(a){return a.model("content").mix("NestedDirtyModel",{$config:{name:"Quiz",plural:"Quizzes",primaryKey:"id"},outcomes:{belongsToMany:"QuizOutcome",keys:"outcome_set"},questions:{belongsToMany:"QuizQuestion",keys:"question_set"}})}]),angular.module("bulbs.quiz.edit.outcomes.outcome",["bettyEditable"]).directive("quizEditOutcomesOutcome",function(){return{controller:["$scope","uuid4",function(a,b){a.uuid=b.generate()}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes-outcome/quiz-edit-outcomes-outcome.html",scope:{outcome:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.edit.outcomes",["bulbs.quiz.api.outcome","bulbs.quiz.edit.outcomes.outcome","utils"]).directive("quizEditOutcomes",function(){return{controller:["$scope","QuizOutcome","Utils",function(a,b,c){a.outcomeMove=function(b,d){c.moveTo(a.outcomes,b,d)},a.outcomeDelete=function(b,d){b.$destroy(),c.removeFrom(a.outcomes,d)},a.outcomeAdd=function(){var c=b.$create({quiz:a.articleId});a.outcomes.push(c)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes.html",scope:{articleId:"=",outcomes:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.questions.question.answer",[]).directive("quizEditQuestionsQuestionAnswer",function(){return{restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question-answer/quiz-edit-questions-question-answer.html",scope:{answer:"=",quizStyle:"=",outcomes:"="}}}),angular.module("bulbs.quiz.edit.questions.question",["bulbs.quiz.api.answer","bulbs.quiz.questions.question.answer","utils"]).directive("quizEditQuestionsQuestion",function(){return{controller:["$scope","QuizAnswer","Utils",function(a,b,c){a.answerMove=function(b,d){c.moveTo(a.question.answers,b,d)},a.answerDelete=function(b,d){b.$destroy(),c.removeFrom(a.question.answers,d)},a.answerAdd=function(c){var d=b.$create({question:a.question.id});a.question.answers.push(d)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question.html",scope:{outcomes:"=",question:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.edit.questions",["bulbs.quiz.api.question","bulbs.quiz.edit.questions.question","utils"]).directive("quizEditQuestions",function(){return{controller:["$scope","QuizQuestion","Utils",function(a,b,c){a.questionMove=function(b,d){c.moveTo(a.questions,b,d)},a.questionDelete=function(b,d){b.$destroy(),c.removeFrom(a.questions,d)},a.questionAdd=function(){var c=b.$create({quiz:a.articleId});a.questions.push(c)}}],restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions.html",scope:{articleId:"=",questions:"=",outcomes:"=",quizStyle:"@"}}}),angular.module("bulbs.quiz.edit",["bulbs.quiz.api.quiz","bulbs.quiz.edit.outcomes","bulbs.quiz.edit.questions"]).directive("quizEdit",[function(){return{restrict:"E",templateUrl:"bulbs/quiz-edit/quiz-edit.html",scope:{articleId:"="},controller:["$scope","Quiz",function(a,b){a.quiz=b.$find(a.articleId)}]}}]),angular.module("bulbs.quiz",["bulbs.quiz.edit","bulbs.quiz.templates"]),angular.module("bulbs.quiz.templates",[]).run(["$templateCache",function(a){a.put("bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes-outcome/quiz-edit-outcomes-outcome.html",'<div class=quiz-edit-outcomes-outcome-headline><label for="quizEditOutcomesOutcomeHeadline{{ uuid }}">Result Headline</label><input id="quizEditOutcomesOutcomeHeadline{{ uuid }}" ng-model=outcome.title placeholder="Title of result"></div><div class=quiz-edit-outcomes-outcome-description><label for="quizEditOutcomesOutcomeDescription{{ uuid }}">Result Description</label><textarea id="quizEditOutcomesOutcomeDescription{{ uuid }}" rows=3 ng-model=outcome.body placeholder="Description of result"></textarea></div><div class=quiz-edit-outcomes-outcome-score ng-show="quizStyle === \'tally\' || quizStyle === \'test\' || quizStyle === \'cosmo\'"><label for="quizEditOutcomesOutcomeScore{{ uuid }}">This result requires a minimum score of:</label><input id="quizEditOutcomesOutcomeScore{{ uuid }}" ng-model=outcome.minScore size=5></div><div class=quiz-edit-outcomes-outcome-shareable><label><input type=checkbox ng-model=outcome.shareable> <span>This result is shareable</span></label></div><div class=quiz-edit-outcomes-outcome-perfect ng-show="quizStyle === \'multiple\'"><label><input type=checkbox ng-model=outcome.requirePerfect> <span>Perfect score required</span></label></div><div class=quiz-edit-outcomes-outcome-image><label>Add Image</label><betty-editable image=outcome.image ratio=1x1 add-styles="fa fa-camera-retro"></betty-editable></div>'),a.put("bulbs/quiz-edit/quiz-edit-outcomes/quiz-edit-outcomes.html",'<div class=quiz-edit-outcomes-header>Possible Results</div><ul><li ng-repeat="outcome in outcomes"><span class=quiz-edit-outcomes-outcome-title><span>Result {{ $index + 1 }}</span> <span ng-if=outcome.title>:</span> <span ng-bind-html="outcome.title | truncateByWords:7"></span></span><div class=quiz-edit-outcomes-outcome-toolbar><div><button ng-click="outcomeMove($index, $index - 1)" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button ng-click="outcomeMove($index, $index + 1)" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div><button title="Delete outcome" ng-click="outcomeDelete(outcome, $index)"><span class="fa fa-trash-o"></span></button></div></div><quiz-edit-outcomes-outcome outcome=outcome quiz-style=quizStyle></quiz-edit-outcomes-outcome></li></ul><div class=quit-edit-outcomes-outcome-add><button ng-click=outcomeAdd()><span class="fa fa-plus"></span> <span>Add A Result</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question-answer/quiz-edit-questions-question-answer.html",'<div class=quiz-edit-questions-question-answer-text><label>Answer:</label><onion-editor ng-model=answer.body role=singleline placeholder=Answer formatting=bold,italic,strike></onion-editor></div><div class=quiz-edit-questions-question-answer-points ng-show="quizStyle === \'tally\' || quizStyle === \'cosmo\'"><label>Points:</label><input ng-model=answer.points size=3></div><div class=quiz-edit-questions-question-answer-result ng-show="quizStyle === \'multiple\'"><label>Connect the answer with this result:</label><select ng-model=answer.outcome ng-options="outcome.id as outcome.title for outcome in outcomes"></select></div><div class=quiz-edit-questions-question-answer-correct ng-show="quizStyle === \'test\'"><label><input type=checkbox ng-model=answer.isCorrect> <span>Correct?</span></label></div><div class=quiz-edit-questions-question-answer-explain ng-show="quizStyle === \'test\'"><label>Answer Explanation:</label><onion-editor ng-model=answer.explanation role=multiline placeholder="Answer Explanation"></onion-editor></div><div class=quiz-edit-questions-question-answer-image><label>Add Image</label><betty-editable image=answer.image ratio=1x1 add-styles="fa fa-camera-retro"></betty-editable></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions-question/quiz-edit-questions-question.html",'<div><label>Question:</label><onion-editor ng-model=question.body role=multiline placeholder="Question Body"></onion-editor><div ng-show="[\'multiple\', \'cosmo\', \'test\'].indexOf(quizStyle) > -1"><label>Optional post-answer content:</label><onion-editor ng-model=question.postAnswerBody role=multiline placeholder="Post Answer Body"></onion-editor></div></div><ul><li ng-repeat="answer in question.answers"><span class=quiz-edit-questions-question-answer-title><span>Answer {{ $index + 1 }}</span> <span ng-if=answer.body>:</span> <span ng-bind-html="answer.body | truncateByWords:7"></span></span><div class=quiz-edit-questions-question-answer-toolbar><div><button ng-click="answerMove($index, $index - 1)" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button ng-click="answerMove($index, $index + 1)" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div><button title="Delete answer" ng-click="answerDelete(answer, $index)"><span class="fa fa-trash-o"></span></button></div></div><quiz-edit-questions-question-answer answer=answer outcomes=outcomes quiz-style=quizStyle></quiz-edit-questions-question-answer></li></ul><div class=quiz-edit-questions-question-answer-add><button ng-click=answerAdd()><span class="fa fa-plus"></span> <span>Add An Answer</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit-questions/quiz-edit-questions.html",'<div class=quiz-edit-questions-header>Questions</div><ul><li ng-repeat="question in questions"><span class=quiz-edit-questions-question-title>Question {{ $index + 1 }}</span><div class=quiz-edit-questions-question-toolbar><div><button ng-click="questionMove($index, $index - 1)" ng-disabled=$first><span class="fa fa-chevron-up"></span></button> <button ng-click="questionMove($index, $index + 1)" ng-disabled=$last><span class="fa fa-chevron-down"></span></button></div><div><button title="Delete question" ng-click="questionDelete(question, $index)"><span class="fa fa-trash-o"></span></button></div></div><quiz-edit-questions-question outcomes=outcomes question=question quiz-style=quizStyle></quiz-edit-questions-question></li></ul><div class=quit-edit-questions-question-add><button ng-click=questionAdd()><span class="fa fa-plus"></span> <span>Add A Question</span></button></div>'),a.put("bulbs/quiz-edit/quiz-edit.html",'<div class=quiz><h1 ng-if="quiz.$dirty().length > 0">QUIZ DIRTY</h1><h1 ng-if="!quiz.$dirty || !quiz.$dirty().length === 0">QUIZ CLEAN</h1><section><div class=form-group ng-show="quiz.quizStyle === \'test\'"><label><input type=checkbox ng-model=quiz.showAllAnswers> <span>Reveal Other Answers After Answering</span></label></div><div class=form-group><label>Customize Result Button Text:</label><input ng-model=quiz.resultButtonText> <span class=text-muted>(Optional: Defaults to "Get Results")</span></div></section><section><quiz-edit-outcomes article-id=quiz.id outcomes=quiz.outcomes quiz-style=quiz.quizStyle></quiz-edit-outcomes></section><section><quiz-edit-questions article-id=quiz.id questions=quiz.questions outcomes=quiz.outcomes quiz-style="{{ quiz.quizStyle }}"></quiz-edit-questions></section></div>')}]);